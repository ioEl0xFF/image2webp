# img2webp GUI版

📄 **DOCXファイルから画像名を抽出し、WebP形式に変換するGUIツール**

直感的なGUIインターフェースで、Word文書内のテーブルから画像名を自動抽出し、複数サイズのWebP画像を生成します。

## ✨ 新機能（GUI版）

- 🖥️ **直感的なGUI**: 使いやすいグラフィカルユーザーインターフェース
- 📁 **ディレクトリ選択**: ダイアログでディレクトリを簡単選択
- 📊 **リアルタイム進捗**: 処理状況をリアルタイムで表示
- 📝 **ログ表示**: 詳細な処理ログをGUI内で確認
- ⚙️ **設定保存**: GUI設定の保存・復元機能
- 🛑 **処理制御**: 処理の開始・停止をGUIで制御
- 🎛️ **品質調整**: WebP品質をスライダーで調整

## 🚀 クイックスタート

### GUIアプリケーションの実行

```bash
# GUI版を直接実行
python gui_main.py
```

### exe化（Windows）

```bash
# ビルドスクリプトを実行
python build_exe.py
```

実行後、`img2webp_distribution/img2webp.exe`が作成されます。

## 🖥️ GUI使用方法

### 1. アプリケーション起動

- `python gui_main.py`を実行するか、`img2webp.exe`をダブルクリック

### 2. ディレクトリ設定

| 項目 | 説明 | 必須 |
|------|------|------|
| **DOCXファイル** | 処理対象のDOCXファイルが入っているディレクトリ | ✅ |
| **画像ファイル** | 元画像ファイル（JPG/PNG/WebP）が入っているディレクトリ | ✅ |
| **HTMLファイル** | HTML置換対象ファイルが入っているディレクトリ | ⭕ |
| **出力先** | 変換後のWebP画像を保存するディレクトリ | ✅ |

### 3. 変換設定

- **WebP品質**: スライダーで1-100の範囲で調整（デフォルト: 100）

### 4. 処理実行

1. 「変換開始」ボタンをクリック
2. 進捗バーとログで処理状況を確認
3. 必要に応じて「停止」ボタンで処理を中断
4. 完了後、出力ディレクトリで結果を確認

### 5. その他の機能

- **ログクリア**: ログ表示エリアをクリア
- **設定保存**: 現在の設定を`gui_settings.json`に保存
- **設定復元**: 起動時に前回の設定を自動復元

## 📋 GUI画面構成

```
┌─────────────────────────────────────────────┐
│          img2webp - 画像変換ツール            │
├─────────────────────────────────────────────┤
│ ディレクトリ設定                              │
│ ┌─────────────────────────────────────────┐ │
│ │ DOCXファイル: [/path/to/docxs    ] [選択]│ │
│ │ 画像ファイル: [/path/to/images   ] [選択]│ │
│ │ HTMLファイル: [/path/to/html     ] [選択]│ │
│ │ 出力先:      [/path/to/output    ] [選択]│ │
│ └─────────────────────────────────────────┘ │
├─────────────────────────────────────────────┤
│ 変換設定                                     │
│ ┌─────────────────────────────────────────┐ │
│ │ WebP品質: [========●=] 85              │ │
│ └─────────────────────────────────────────┘ │
├─────────────────────────────────────────────┤
│ [変換開始] [停止] [ログクリア] [設定保存]      │
├─────────────────────────────────────────────┤
│ ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ │ 進捗バー
│ 準備完了                                     │
├─────────────────────────────────────────────┤
│ 処理ログ                                     │
│ ┌─────────────────────────────────────────┐ │
│ │ 12:34:56 - INFO - 変換処理を開始します     │ │
│ │ 12:34:57 - INFO - ファイル処理開始: xxx.docx│ │
│ │ 12:34:58 - SUCCESS - 完了: xxx.docx       │ │
│ │ 12:35:00 - SUCCESS - 変換処理が完了しました │ │
│ │                                         │ │
│ │                                         │ │
│ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
```

## 🔧 exe化の詳細

### 必要な環境

- **Python**: 3.7以上
- **PyInstaller**: 5.0.0以上
- **必要パッケージ**: python-docx, Pillow

### ビルド手順

1. **依存関係のインストール**:
   ```bash
   pip install python-docx Pillow pyinstaller
   ```

2. **ビルドスクリプト実行**:
   ```bash
   python build_exe.py
   ```

3. **生成されるファイル**:
   - `img2webp.exe`: 実行ファイル（約20-30MB）
   - `img2webp_distribution/`: 配布用フォルダ

### ビルド設定

- **実行ファイル名**: `img2webp.exe`
- **コンソール**: 非表示（GUIアプリケーション）
- **アイコン**: `icon.ico`（存在する場合）
- **バージョン情報**: `version_info.txt`
- **圧縮**: UPX圧縮有効

## 📊 コマンドライン版との比較

| 機能 | コマンドライン版 | GUI版 |
|------|------------------|-------|
| **操作性** | コマンド入力 | 直感的なGUI |
| **設定管理** | config.py編集 | GUI内で調整 |
| **進捗確認** | ログファイル | リアルタイム表示 |
| **エラー確認** | ログファイル | GUI内で即座に確認 |
| **バッチ処理** | ✅ | ✅ |
| **exe化** | 可能 | ✅ 簡単 |
| **初心者向け** | ⭕ | ✅ |
| **自動化** | ✅ | ⭕ |

## 🛠️ トラブルシューティング

### GUI関連

| 問題 | 原因 | 解決方法 |
|------|------|----------|
| 起動しない | Pythonパスの問題 | `python gui_main.py`で実行 |
| ディレクトリ選択できない | 権限の問題 | 管理者権限で実行 |
| ログが表示されない | スレッドの問題 | アプリケーション再起動 |
| 設定が保存されない | 書き込み権限なし | フォルダの権限を確認 |

### exe化関連

| 問題 | 原因 | 解決方法 |
|------|------|----------|
| ビルドエラー | PyInstaller未インストール | `pip install pyinstaller` |
| 実行ファイルが大きい | 依存関係が多い | 仕様（20-30MB程度） |
| 起動が遅い | 初回展開 | 仕様（2回目以降は高速） |
| セキュリティ警告 | 署名なし | Windows Defender設定を調整 |

## 📈 パフォーマンス

### 処理速度

- **小規模** (10ファイル、50画像): 約30秒
- **中規模** (50ファイル、200画像): 約2分
- **大規模** (100ファイル、500画像): 約5分

### メモリ使用量

- **GUI版**: 約50-100MB
- **exe版**: 約70-120MB（初回展開時）

## 🔄 更新履歴

- **v2.0**: 🎉 **GUI版リリース**
  - Tkinterベースの直感的なGUI
  - リアルタイム進捗表示
  - 設定保存・復元機能
  - exe化対応
  - ログ表示機能
  - 処理制御機能（開始・停止）

## 🤝 サポート

- **バグ報告**: Issue作成
- **機能要望**: Pull Request歓迎
- **使用方法**: README参照

## 📄 ライセンス

このプロジェクトのライセンスについては、プロジェクトのライセンスファイルを参照してください。
